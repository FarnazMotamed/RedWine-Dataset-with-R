WineQualityReds by Farnaz_Motamediyan
========================================================

```{r echo=FALSE, message=FALSE, warning=FALSE, packages}
library(ggplot2)
library(dplyr)
library(gridExtra)
library(MASS)
library(scales)

```

```{r echo=FALSE, Load_the_Data}
#setwd("~/Developer/data-analysis/EDA with R")
RedWineData= read.csv("wineQualityReds.csv")
names(RedWineData)
str(RedWineData)
nrow(RedWineData)
ncol(RedWineData)
summary(RedWineData)
summary(RedWineData$quality)
```

> 
RedWineData dataset has 13 variables of 1599 entries:
"fixed.acidity","volatile.acidity","citric.acid","residual.sugar","chlorides","free.sulfur.dioxide","total.sulfur.dioxide","density","pH","sulphates","alcohol","quality"
Quality is an ordinal variable with possible ranking from 1 (worst) to 10 (best).

# Univariate Plots Section


```{r echo=FALSE, Univariate_Plots}

wine_quality_groups= group_by(RedWineData,quality)
cor.test(RedWineData$quality ,RedWineData$fixed.acidity , method="pearson")

with(subset(RedWineData, quality > 6), cor.test(quality, fixed.acidity))
#scatered plot
ggplot(aes(y=total.sulfur.dioxide, x=quality), data=RedWineData)+ 
  geom_point()
#histogram plots of all variables
grid.arrange(qplot(RedWineData$fixed.acidity),
             qplot(RedWineData$volatile.acidity),
             qplot(RedWineData$citric.acid),
             qplot(RedWineData$residual.sugar),
             qplot(RedWineData$chlorides),
             qplot(RedWineData$free.sulfur.dioxide),
             qplot(RedWineData$total.sulfur.dioxide),
             qplot(RedWineData$density),
             qplot(RedWineData$pH),
             qplot(RedWineData$sulphates),
             qplot(RedWineData$alcohol),
             qplot(RedWineData$quality),
             ncol = 4)

```


# Univariate Analysis


I myself am a Red Wine lover. In this dataset first variable that caught my interest was the quality of wine. It is usually ranked from 1 to 10, however, in this dataset is ranked from 1 to 8. Here in the bellow histogram, I categorized the data set by good(>=7) average(5 =< Avg <7) and poor(<5) wine based on its quality. 

```{r}
RedWineData$qualityrating <- ifelse(RedWineData$quality < 5, 'poor', ifelse(
  RedWineData$quality < 7, 'average', 'good'))
RedWineData$qualityrating <- ordered(RedWineData$qualityrating,
                     levels = c('poor', 'average', 'good'))
summary(RedWineData$qualityrating)
qplot(RedWineData$qualityrating)
```

#Distributions and Outliers
Looking at the first rounds of histograms that I created to look at my variables, have it appears that Qualitatively, residual sugar and chlorides have extreme outliers. Citric has a large number of zero values, however, i'm wondering whether this is a case of non-reporting of values.
It looks like density and pH are normally distributed, with only few outliers.
sulfur dioxides, fixed and volatile acidity, sulphates, and alcohol seem to be long-tailed.

Arguments Log10: log is a character string which contains "x" if the x axis is to be logarithmic. here I used log10
```{r}
ggplot(data = RedWineData,
       aes(x = citric.acid)) +
  geom_histogram() 
  
ggplot(data = RedWineData,
       aes(x = fixed.acidity)) +
  geom_histogram() +
  scale_x_log10()

ggplot(data = RedWineData,
       aes(x = volatile.acidity)) +
  geom_histogram() +
  scale_x_log10()
```
we can see that fixed.acidity and volatile.acidity appear to be normally-distributed.
 

### Did you create any new variables from existing variables in the dataset?
I created a new variable as qualityrating to rate the quality of wine as good average and poor.

### Of the features you investigated, were there any unusual distributions? \
Did you perform any operations on the data to tidy, adjust, or change the form \
of the data? If so, why did you do this?

I addressed the distributions in the 'Distributions and outliers' section.
Here I will continue to visualize the outliers by Boxplots. But it is important to mention that at the end I did not perform any operations on the data to tidy or adjust or change the form of the data here at Univariate Analysis section. However, I will do so with the Bivariable section.
In order to make visualization by boxplots, first I define a new function to create boxplot for each variable.


```{r}
boxplot(RedWineData , las=2)
```
# Bivariate Plots Section


```{r echo=FALSE, Bivariate_Plots}

get_bivariate_boxplot <- function(x, y, ylab) {
  return(qplot(data = RedWineData, x = x, y = y, geom = 'boxplot', ylab = ylab))
}

grid.arrange(get_bivariate_boxplot(RedWineData$quality,RedWineData$fixed.acidity,'fixed acidity'),
             get_bivariate_boxplot(RedWineData$quality,RedWineData$volatile.acidity,'volatile acidity'),
             get_bivariate_boxplot(RedWineData$quality,RedWineData$citric.acid,'citric acid'),
             get_bivariate_boxplot(RedWineData$quality, log10(RedWineData$residual.sugar), 'residual sugar'),
             get_bivariate_boxplot(RedWineData$quality, log10(RedWineData$chlorides),'chlorides'),
             get_bivariate_boxplot(RedWineData$quality,RedWineData$free.sulfur.dioxide,'free sulf. dioxide'),
             get_bivariate_boxplot(RedWineData$quality,RedWineData$total.sulfur.dioxide, 'total sulf. dioxide'),
             get_bivariate_boxplot(RedWineData$quality,RedWineData$density,
                                   'density'),
             get_bivariate_boxplot(RedWineData$quality,RedWineData$pH, 'pH'),
             get_bivariate_boxplot(RedWineData$quality, log10(RedWineData$sulphates), 'sulphates'),
             get_bivariate_boxplot(RedWineData$quality, RedWineData$alcohol, 'alcohol'),
             ncol = 4)


```

# Bivariate Analysis


### Talk about some of the relationships you observed in this part of the \
investigation. How did the feature(s) of interest vary with other features in \
the dataset?

It showes at the above plots that a good wine has a lower pH and higher acidic, as an example.


### What was the strongest relationship you found?
```{r}

correlations_test <- function(x, y) {
  return(cor.test(x, as.numeric(y))$estimate)
}

correlations <- c(
  correlations_test(RedWineData$fixed.acidity, RedWineData$quality),
  correlations_test(RedWineData$volatile.acidity, RedWineData$quality),
  correlations_test(RedWineData$citric.acid, RedWineData$quality),
  correlations_test(log10(RedWineData$residual.sugar), RedWineData$quality),
  correlations_test(log10(RedWineData$chlorides), RedWineData$quality),
  correlations_test(RedWineData$free.sulfur.dioxide, RedWineData$quality),
  correlations_test(RedWineData$total.sulfur.dioxide, RedWineData$quality),
  correlations_test(RedWineData$density, RedWineData$quality),
  correlations_test(RedWineData$pH, RedWineData$quality),
  correlations_test(log10(RedWineData$sulphates), RedWineData$quality),
  correlations_test(RedWineData$alcohol, RedWineData$quality))
names(correlations) <- c('fixed.acidity', 'volatile.acidity', 'citric.acid', 'log10.residual.sugar',
'log10.chlordies', 'free.sulfur.dioxide',
'total.sulfur.dioxide', 'density', 'pH',
'log10.sulphates', 'alcohol')
correlations
```


and here is re result for correlations:
fixed.acidity     volatile.acidity          citric.acid log10.residual.sugar 
          0.12405165          -0.39055778           0.22637251           0.02353331 
     log10.chlordies  free.sulfur.dioxide total.sulfur.dioxide              density 
         -0.17613996          -0.05065606          -0.18510029          -0.17491923 
                  pH      log10.sulphates              alcohol 
         -0.05773139           0.30864193           0.47616632 
         
As it appears, alcohol, sulphates, volatile acidity and citric acide have the highest correlations to quality. 

# Multivariate Plots Section

```{r echo=FALSE, Multivariate_Plots}
ggplot(data = RedWineData,aes(x = citric.acid, y = volatile.acidity,color = quality)) +geom_point()

ggplot(data = RedWineData,
       aes(x = alcohol, y = log10(sulphates),
           color = quality)) +
  geom_point()

ggplot(data = RedWineData,
       aes(x = pH, y = alcohol, color = quality)) +
  geom_point()
```

# Multivariate Analysis

Because the plot could get very tense, crowded and hard to read, I used facet_wrap(~qualityrating) to reduce the crowdedness of my models and plots. I tried to identify and illustrate the 4 most correlated features to the quality of wines. As it is shown, higher citric acid and lower volatile acid could produce a better (in terms of quality) wine. higher sulphates and higher alcohol(%) also shared contribution to a more high-quality wine.

------

# Final Plots and Summary

### Plot One
```{r echo=FALSE, Plot_One}
ggplot(data = subset(RedWineData ,qualityrating != 'average'), aes(x = volatile.acidity, y = alcohol, color = quality)) + geom_point() + ggtitle('Alcohol vs. Volatile Acidity and Wine Quality') + xlab('Volatile Acidity (g / dm^3)') + ylab('Alcohol (% volume)')
```

### Description One
I have done rating as good, average and poor. I named the new variable quality rating. in this scattered plot I neglected the average rate and only considered good and poor quality wines. I initially wanted to see the correlation of alcohol and volatile acidity on the quality of wine. As it is visible, higher volatile acidity brings down the quality of wine. Higher quality wines also tend to have higher alcohol. as a result, i can see that higher percentage of alcohol combined with lower volatile acidity produced a better wine in terms of quality.

Here I will try to visualise the correlation of each of my variables(in the first plot) with quality in order to support my argument.
### Plot Two
```{r echo=FALSE, Plot_Two}
ggplot(data = RedWineData, aes(x = quality, y = alcohol,
                      fill = qualityrating)) +
  geom_boxplot() +
  ggtitle('percentage of Alcohol in Wine Qualities') +
  xlab('Quality') +
  ylab('Alcohol (% volume)')
```

### Description Two
Here in these three boxplots we can see the effect of alcohol in the quality of wine. I personaly don't like the argument of ' higher alcohol results in higher quality of wine'. In fact I argue that the combination of higher alcohol and other factors will produce higher qualities. and the outliers here also showes that alcohol by itself alone is not a strong indicator of high quality wine.

### Plot Three
```{r echo=FALSE, Plot_Three}
grid.arrange(ggplot(data = RedWineData, aes(x = quality, y = fixed.acidity,
                                   fill = quality)) + 
               ylab('Fixed Acidity (g/dm^3)') +
               xlab('Quality') +
               geom_boxplot(),
             ggplot(data = RedWineData, aes(x = quality, y = volatile.acidity,
                                   fill = quality)) +
               ylab('Volatile Acidity (g/dm^3)') +
               xlab('Quality') +
               geom_boxplot(), 
             ggplot(data = RedWineData, aes(x = quality, y = citric.acid,
                                   fill = quality)) +
               ylab('Citric Acid (g/dm^3)') +
               xlab('Quality') +
               geom_boxplot(), 
             ggplot(data = RedWineData, aes(x = quality, y = pH,
                                   fill = quality)) +
               ylab('pH') +
               xlab('Quality') +
               geom_boxplot())
```

### Description Three

As I have identified it at the first plot here, higher acidity or lower pH is recognized in higher quality wines.

# Reflection

This EDA or exploratory data analysis helped me gain insights about the redwinequality dataset. i was able to visualize relationships and correlations of different variables. I was able to identify the most related variables to the quality of red wine. As it appears, alcohol, sulphates, volatile acidity and citric acide have the highest correlations to the quality of red wines.